<!-- æ˜¥æ—¥æ¨±èŠ±ä¸»é¢˜ä¸“å±åŠ è½½é®ç½© -->
<div id="page-loader" class="page-loader page-loader-sakura">
    <canvas id="matrix-canvas" class="loader-matrix-canvas"></canvas>

    <div class="loader-content">
        <div class="loader-sakura-text">
            <span>æ˜¥æ—¥åŠ è½½ä¸­</span>
            <span class="loader-sakura-icon">ğŸŒ¸</span>
        </div>
    </div>
</div>

<style>
    /* æ¨±èŠ± loader ä¸“å±æ ·å¼ */
    .page-loader-sakura {
        background: linear-gradient(160deg, #fff5f8 0%, #fde8ef 40%, #f9d4e2 100%);
    }

    .loader-sakura-text {
        font-family: 'PingFang SC', 'Hiragino Sans GB', sans-serif;
        font-size: 1rem;
        letter-spacing: 0.2em;
        color: #c0506a;
        display: flex;
        align-items: center;
        gap: 0.5em;
        padding: 0.6em 1.6em;
        border: 1px solid rgba(210, 100, 130, 0.25);
        background: rgba(255, 255, 255, 0.55);
        backdrop-filter: blur(12px);
        border-radius: 50px;
        box-shadow:
            0 4px 20px rgba(210, 100, 130, 0.12),
            inset 0 1px 0 rgba(255, 255, 255, 0.8);
    }

    /* èŠ±æœµå›¾æ ‡æ‘‡æ‘† */
    .loader-sakura-icon {
        animation: sakuraSwing 2s ease-in-out infinite;
        display: inline-block;
        transform-origin: center bottom;
    }

    @keyframes sakuraSwing {

        0%,
        100% {
            transform: rotate(-8deg);
        }

        50% {
            transform: rotate(8deg);
        }
    }
</style>

<script>
    (function () {
        const canvas = document.getElementById('matrix-canvas');
        if (!canvas) return;
        const ctx = canvas.getContext('2d');
        const loader = document.getElementById('page-loader');

        // æ£€æŸ¥åŠ è½½å±åŠ¨ç”»å¼€å…³
        if (localStorage.getItem('anim-loader') === 'false') {
            canvas.style.display = 'none';
            return;
        }

        let width, height;

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            initPetals();
        }

        window.addEventListener('resize', resize);

        // èŠ±ç“£ç²’å­
        const PETAL_COUNT = 40;
        let petals = [];

        // èŠ±ç“£é¢œè‰²æ± ï¼šç²‰è‰²ç³»
        const PETAL_COLORS = [
            'rgba(255, 182, 193, ALPHA)',  // æµ…ç²‰
            'rgba(255, 150, 170, ALPHA)',  // ä¸­ç²‰
            'rgba(240, 120, 150, ALPHA)',  // æ·±ç²‰
            'rgba(255, 200, 210, ALPHA)',  // ç±³ç²‰
            'rgba(250, 165, 185, ALPHA)',  // æš–ç²‰
        ];

        function createPetal(randomY) {
            return {
                x: Math.random() * width,
                y: randomY ? Math.random() * height : -20,
                // æ¼‚ç§»é€Ÿåº¦
                vx: (Math.random() - 0.5) * 1.2,
                vy: 0.5 + Math.random() * 1.2,
                // æ—‹è½¬
                angle: Math.random() * Math.PI * 2,
                angularV: (Math.random() - 0.5) * 0.06,
                // å¤§å°
                size: 2 + Math.random() * 5,
                // é¢œè‰²
                colorTemplate: PETAL_COLORS[Math.floor(Math.random() * PETAL_COLORS.length)],
                alpha: 0.4 + Math.random() * 0.5,
                // æ‘†åŠ¨
                swingPhase: Math.random() * Math.PI * 2,
                swingSpeed: 0.02 + Math.random() * 0.02,
            };
        }

        function initPetals() {
            petals = [];
            for (let i = 0; i < PETAL_COUNT; i++) {
                petals.push(createPetal(true));
            }
        }

        // åŠ è½½ç”¨æˆ·æä¾›çš„çœŸå®èŠ±ç“£è´´å›¾
        const petalImage = new Image();
        petalImage.src = 'data:image/png;base64,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'

        resize();

        // ç»˜åˆ¶å•ä¸ªèŠ±ç“£å›¾ç‰‡
        function drawPetal(p) {
            ctx.save();
            // åœ¨èŠ±ç“£åæ ‡ç‚¹åº”ç”¨å…¨å±€é€æ˜åº¦ï¼Œäº§ç”Ÿè·ç¦»æ¨¡ç³Šæˆ–è‹¥éšè‹¥ç°æ„Ÿ
            ctx.globalAlpha = p.alpha;

            ctx.translate(p.x, p.y);
            ctx.rotate(p.angle);

            // ä¾æ®åŸæœ‰çš„èŠ±ç“£ç¼©æ”¾å› å­ï¼Œè°ƒæ•´åŸå›¾æ¸²æŸ“å®½åº¦ï¼Œå› ä¸ºå›¾ç‰‡æœ¬æ¥å°±æ˜¯çœŸå®çš„ï¼Œæ‰€ä»¥ä¿æŒé•¿å®½ç­‰æ¯”ä¾‹æ”¾å¤§ç¼©å°
            const renderSize = p.size * 5;

            // ä½¿å¾—æ—‹è½¬æ—¶ä»¥èŠ±ç“£è‡ªèº«ä¸ºä¸­å¿ƒ
            ctx.drawImage(petalImage, -renderSize / 2, -renderSize / 2, renderSize, renderSize);

            ctx.restore();
        }

        let lastDraw = 0;
        const fps = 24;

        function draw(timestamp) {
            if (loader.style.display === 'none') return;
            if (timestamp - lastDraw < 1000 / fps) {
                requestAnimationFrame(draw);
                return;
            }
            lastDraw = timestamp;

            ctx.clearRect(0, 0, width, height);

            for (let p of petals) {
                // æ‘†åŠ¨æ•ˆæœï¼ˆæ­£å¼¦æ¼‚ç§»ï¼‰
                p.swingPhase += p.swingSpeed;
                p.x += p.vx + Math.sin(p.swingPhase) * 0.5;
                p.y += p.vy;
                p.angle += p.angularV;

                // è¶…å‡ºåº•éƒ¨æ—¶ä»é¡¶éƒ¨é‡ç”Ÿ
                if (p.y > height + 30) {
                    Object.assign(p, createPetal(false));
                }
                // è¶…å‡ºå·¦å³è¾¹ç•Œæ—¶æŠ˜è¿”
                if (p.x < -30) p.x = width + 30;
                if (p.x > width + 30) p.x = -30;

                drawPetal(p);
            }

            requestAnimationFrame(draw);
        }

        requestAnimationFrame(draw);
    })();
</script>